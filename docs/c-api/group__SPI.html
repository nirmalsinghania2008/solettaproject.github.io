<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Soletta: SPI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Soletta
   </div>
   <div id="projectbrief">Framework for making IoT devices</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPI<div class="ingroups"><a class="el" href="group__IO.html">I/O</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsol__spi__config.html">sol_spi_config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga40715871e4b12b677a23dbd9a8247076"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga40715871e4b12b677a23dbd9a8247076">SOL_SPI_DATA_BITS_DEFAULT</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ga40715871e4b12b677a23dbd9a8247076"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaae4dc76ae4e9d14906fa85ed46166362"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#gaae4dc76ae4e9d14906fa85ed46166362">sol_spi_mode</a> { <a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362aed31f6c5aa29f6939643a84d146c1bb5">SOL_SPI_MODE_0</a> = 0, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362a2b842a38daf8b2275fdd7b7c4d31a95b">SOL_SPI_MODE_1</a>, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362adb708746734272271a3467790e35f883">SOL_SPI_MODE_2</a>, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362a4445edd049cb415353fa6f9afeb792b0">SOL_SPI_MODE_3</a>
 }</td></tr>
<tr class="separator:gaae4dc76ae4e9d14906fa85ed46166362"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga909f9825eb18e480bb5c05ceff4ee458"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga909f9825eb18e480bb5c05ceff4ee458">sol_spi_close</a> (struct <a class="el" href="structsol__spi.html">sol_spi</a> *spi)</td></tr>
<tr class="separator:ga909f9825eb18e480bb5c05ceff4ee458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ae35b4b1edd15bc0156543afa31cff8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsol__spi.html">sol_spi</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga1ae35b4b1edd15bc0156543afa31cff8">sol_spi_open</a> (unsigned int bus, const struct <a class="el" href="structsol__spi__config.html">sol_spi_config</a> *<a class="el" href="mqtt-subscribe_8c.html#af8ad2fb90ab9daa46f40f12118751b58">config</a>)</td></tr>
<tr class="separator:ga1ae35b4b1edd15bc0156543afa31cff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab25170293f64d99e713c28cd0078e50"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#gaab25170293f64d99e713c28cd0078e50">sol_spi_transfer</a> (struct <a class="el" href="structsol__spi.html">sol_spi</a> *spi, const uint8_t *tx, uint8_t *rx, size_t count, void(*transfer_cb)(void *cb_data, struct <a class="el" href="structsol__spi.html">sol_spi</a> *spi, const uint8_t *tx, uint8_t *rx, ssize_t status), const void *cb_data)</td></tr>
<tr class="separator:gaab25170293f64d99e713c28cd0078e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>SPI (Serial Peripheral Interface) API for Soletta. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga40715871e4b12b677a23dbd9a8247076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOL_SPI_DATA_BITS_DEFAULT&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="gaae4dc76ae4e9d14906fa85ed46166362"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__SPI.html#gaae4dc76ae4e9d14906fa85ed46166362">sol_spi_mode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362aed31f6c5aa29f6939643a84d146c1bb5"></a>SOL_SPI_MODE_0</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362a2b842a38daf8b2275fdd7b7c4d31a95b"></a>SOL_SPI_MODE_1</em>&#160;</td><td class="fielddoc">
<p>CPOL = 0 and CPHA = 0 </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362adb708746734272271a3467790e35f883"></a>SOL_SPI_MODE_2</em>&#160;</td><td class="fielddoc">
<p>CPOL = 0 and CPHA = 1 </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362a4445edd049cb415353fa6f9afeb792b0"></a>SOL_SPI_MODE_3</em>&#160;</td><td class="fielddoc">
<p>CPOL = 1 and CPHA = 0 CPOL = 1 and CPHA = 1 </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga909f9825eb18e480bb5c05ceff4ee458"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sol_spi_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsol__spi.html">sol_spi</a> *&#160;</td>
          <td class="paramname"><em>spi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close an SPI bus.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>The SPI bus handle </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structsol__spi.html#a3bdc28d35cfc747b474384bd082cf2d3">sol_spi::bus</a>, <a class="el" href="structsol__spi.html#acbf7e3ad6fccc777269057bfec5a2b5d">sol_spi::fd</a>, <a class="el" href="group__Log.html#gacb48844cf78438b772f069c089836835">SOL_NULL_CHECK</a>, <a class="el" href="group__Mainloop.html#gae1f45ba3de62603e90903d1214cf834f">sol_timeout_del()</a>, <a class="el" href="sol-worker-thread_8h.html#a7d60d6443f27e0c7a4a51fd4171124b6">sol_worker_thread_cancel()</a>, <a class="el" href="structsol__spi.html#a37b269f91dec39ccffa2960efff19ef8">sol_spi::timeout</a>, and <a class="el" href="structsol__spi.html#a78e94900ca9fc58efaf240cfe0a195ef">sol_spi::transfer</a>.</p>

</div>
</div>
<a class="anchor" id="ga1ae35b4b1edd15bc0156543afa31cff8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsol__spi.html">sol_spi</a>* sol_spi_open </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>bus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structsol__spi__config.html">sol_spi_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open an SPI bus.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bus</td><td>The SPI bus number to open </td></tr>
    <tr><td class="paramname">config</td><td>The SPI bus configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new SPI bus handle</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For now it only supports one user of the bus at time, 2 or mode devices with different chip select on the same bus will cause concurrency errors. </dd></dl>

<p>References <a class="el" href="structsol__spi__config.html#a3442aaa7156c397f54eb3a174c90681e">sol_spi_config::api_version</a>, <a class="el" href="structsol__spi.html#a01b081dcd8fd1d56c2e5403ab3df89e9">sol_spi::bits_per_word</a>, <a class="el" href="structsol__spi__config.html#a8b19918fdd563d29d52edc0bfda56468">sol_spi_config::bits_per_word</a>, <a class="el" href="structsol__spi.html#a3bdc28d35cfc747b474384bd082cf2d3">sol_spi::bus</a>, <a class="el" href="structsol__spi.html#aa04938f8373d05867b50e9fdd0d9e137">sol_spi::chip_select</a>, <a class="el" href="structsol__spi__config.html#a0d52dc122a2c1db83c8f01cbf716bffd">sol_spi_config::chip_select</a>, <a class="el" href="structsol__spi.html#a3f6dfebc924c7087418d998480c6a98c">sol_spi::cs_pin</a>, <a class="el" href="structsol__spi.html#acbf7e3ad6fccc777269057bfec5a2b5d">sol_spi::fd</a>, <a class="el" href="structsol__spi__config.html#a9f0591f7da87d16614f6f99dddb5934d">sol_spi_config::frequency</a>, <a class="el" href="structsol__spi__config.html#a18d159b58fc26d7a5fa623a0457e7e2b">sol_spi_config::mode</a>, <a class="el" href="group__Log.html#ga7ceb60c9648222c6d1fa660ec9fc1fe6">SOL_EXP_CHECK</a>, <a class="el" href="sol-log-internal_8h.html#a165cdb89cfc86be0c15766fdf5c9b833">SOL_LOG_INTERNAL_INIT_ONCE</a>, <a class="el" href="group__Log.html#gacb48844cf78438b772f069c089836835">SOL_NULL_CHECK</a>, <a class="el" href="sol-spi_8h.html#a2b0907b70eba4d34f2115363e5b87a0b">SOL_SPI_CONFIG_API_VERSION</a>, <a class="el" href="sol-util_8h.html#ab584188ab3f38605dab8b04aaa85913d">sol_util_strerrora</a>, <a class="el" href="group__Log.html#ga5d9529e9746395acc2cd96a28ffa1c28">SOL_WRN</a>, <a class="el" href="structsol__spi.html#a37b269f91dec39ccffa2960efff19ef8">sol_spi::timeout</a>, <a class="el" href="structsol__spi.html#a78e94900ca9fc58efaf240cfe0a195ef">sol_spi::transfer</a>, and <a class="el" href="sol-util_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="gaab25170293f64d99e713c28cd0078e50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sol_spi_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structsol__spi.html">sol_spi</a> *&#160;</td>
          <td class="paramname"><em>spi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *cb_data, struct <a class="el" href="structsol__spi.html">sol_spi</a> *spi, const uint8_t *tx, uint8_t *rx, ssize_t status)&#160;</td>
          <td class="paramname"><em>transfer_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cb_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform a SPI asynchronous transfer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>The SPI bus handle </td></tr>
    <tr><td class="paramname">tx</td><td>The output buffer </td></tr>
    <tr><td class="paramname">rx</td><td>The input buffer </td></tr>
    <tr><td class="paramname">count</td><td>number of bytes to be transfer </td></tr>
    <tr><td class="paramname">transfer_cb</td><td>callback to be called when transmission finish, in case of success the status parameters on callback should be the same value as count, otherwise a error happen. </td></tr>
    <tr><td class="paramname">cb_data</td><td>user data, first parameter of transfer_cb </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if transfer was started.</dd></dl>
<p>As SPI works in full-duplex, data are going in and out at same time, so both buffers must have the count size. Caller should guarantee that both buffers will not be freed until callback is called. Also there is no transfer queue, calling this function when there is transfer happening would return false. </p>

<p>References <a class="el" href="structsol__worker__thread__spec.html#afd3226b91658a3d3236a0d780dc6739a">sol_worker_thread_spec::api_version</a>, <a class="el" href="structsol__spi.html#a4d1e40baed5292b475e5eb1b3da5552f">sol_spi::cb</a>, <a class="el" href="structsol__spi.html#ada6f54bb8789d7ac48bf38831d69ffbf">sol_spi::cb_data</a>, <a class="el" href="structsol__spi.html#a337e98c61efa5a7691574430862fd75f">sol_spi::count</a>, <a class="el" href="structsol__spi.html#a2f0e895696b7a9d4deff77e856e01b41">sol_spi::intern_allocated_buffer_flags</a>, <a class="el" href="sol-spi-impl-riot_8c.html#a8c1900656c092065b231deb04ee8f613">INTERN_ALLOCATED_RX_BUFFER</a>, <a class="el" href="sol-spi-impl-riot_8c.html#ac1a2e1d7309e1758c5ced4c433c8477b">INTERN_ALLOCATED_TX_BUFFER</a>, <a class="el" href="structsol__spi.html#a98e71f585b569692c4b6c621c29b4cf2">sol_spi::rx</a>, <a class="el" href="group__Log.html#ga7ceb60c9648222c6d1fa660ec9fc1fe6">SOL_EXP_CHECK</a>, <a class="el" href="group__Log.html#ga8b7a2ba17c9bf66ad98238f0ca591413">SOL_INT_CHECK</a>, <a class="el" href="group__Log.html#gacb48844cf78438b772f069c089836835">SOL_NULL_CHECK</a>, <a class="el" href="group__Log.html#ga54e82836a0158b537774689043b0fb75">SOL_NULL_CHECK_GOTO</a>, <a class="el" href="group__Mainloop.html#ga1e05a71a099eebeac9c2848e3661132b">sol_timeout_add()</a>, <a class="el" href="sol-worker-thread_8h.html#a647f164a728db00772ae47afc12d0653">sol_worker_thread_new()</a>, <a class="el" href="sol-worker-thread_8h.html#a13e852aa5ab554f4c230f1c5d2226b36">SOL_WORKER_THREAD_SPEC_API_VERSION</a>, <a class="el" href="structsol__spi.html#a9eeed3b7baa9f1b8b734e37459ae1ca2">sol_spi::status</a>, <a class="el" href="structsol__spi.html#a37b269f91dec39ccffa2960efff19ef8">sol_spi::timeout</a>, <a class="el" href="structsol__spi.html#a78e94900ca9fc58efaf240cfe0a195ef">sol_spi::transfer</a>, and <a class="el" href="structsol__spi.html#acebd05a16bc698a0f03574d2b6a5bfb8">sol_spi::tx</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
