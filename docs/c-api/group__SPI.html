<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Soletta: SPI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Soletta
   </div>
   <div id="projectbrief">Framework for making IoT devices</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPI<div class="ingroups"><a class="el" href="group__IO.html">I/O</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>SPI (Serial Peripheral Interface) API for Soletta.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsol__spi__config.html">sol_spi_config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga40715871e4b12b677a23dbd9a8247076"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga40715871e4b12b677a23dbd9a8247076">SOL_SPI_DATA_BITS_DEFAULT</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ga40715871e4b12b677a23dbd9a8247076"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default value for bits per word when using SPI.  <a href="#ga40715871e4b12b677a23dbd9a8247076">More...</a><br /></td></tr>
<tr class="separator:ga40715871e4b12b677a23dbd9a8247076"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaae4dc76ae4e9d14906fa85ed46166362"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#gaae4dc76ae4e9d14906fa85ed46166362">sol_spi_mode</a> { <a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362aed31f6c5aa29f6939643a84d146c1bb5">SOL_SPI_MODE_0</a> = 0, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362a2b842a38daf8b2275fdd7b7c4d31a95b">SOL_SPI_MODE_1</a>, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362adb708746734272271a3467790e35f883">SOL_SPI_MODE_2</a>, 
<a class="el" href="group__SPI.html#ggaae4dc76ae4e9d14906fa85ed46166362a4445edd049cb415353fa6f9afeb792b0">SOL_SPI_MODE_3</a>
 }<tr class="memdesc:gaae4dc76ae4e9d14906fa85ed46166362"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Transfer Modes.  <a href="group__SPI.html#gaae4dc76ae4e9d14906fa85ed46166362">More...</a><br /></td></tr>
<tr class="separator:gaae4dc76ae4e9d14906fa85ed46166362"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga909f9825eb18e480bb5c05ceff4ee458"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga909f9825eb18e480bb5c05ceff4ee458">sol_spi_close</a> (struct sol_spi *spi)</td></tr>
<tr class="memdesc:ga909f9825eb18e480bb5c05ceff4ee458"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close an SPI bus.  <a href="#ga909f9825eb18e480bb5c05ceff4ee458">More...</a><br /></td></tr>
<tr class="separator:ga909f9825eb18e480bb5c05ceff4ee458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ae35b4b1edd15bc0156543afa31cff8"><td class="memItemLeft" align="right" valign="top">struct sol_spi *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#ga1ae35b4b1edd15bc0156543afa31cff8">sol_spi_open</a> (unsigned int bus, const struct <a class="el" href="structsol__spi__config.html">sol_spi_config</a> *<a class="el" href="mqtt-subscribe_8c.html#af8ad2fb90ab9daa46f40f12118751b58">config</a>)</td></tr>
<tr class="memdesc:ga1ae35b4b1edd15bc0156543afa31cff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open an SPI bus.  <a href="#ga1ae35b4b1edd15bc0156543afa31cff8">More...</a><br /></td></tr>
<tr class="separator:ga1ae35b4b1edd15bc0156543afa31cff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab25170293f64d99e713c28cd0078e50"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI.html#gaab25170293f64d99e713c28cd0078e50">sol_spi_transfer</a> (struct sol_spi *spi, const uint8_t *tx, uint8_t *rx, size_t count, void(*transfer_cb)(void *cb_data, struct sol_spi *spi, const uint8_t *tx, uint8_t *rx, ssize_t status), const void *cb_data)</td></tr>
<tr class="memdesc:gaab25170293f64d99e713c28cd0078e50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a SPI asynchronous transfer.  <a href="#gaab25170293f64d99e713c28cd0078e50">More...</a><br /></td></tr>
<tr class="separator:gaab25170293f64d99e713c28cd0078e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>SPI (Serial Peripheral Interface) API for Soletta. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga40715871e4b12b677a23dbd9a8247076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOL_SPI_DATA_BITS_DEFAULT&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default value for bits per word when using SPI. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="gaae4dc76ae4e9d14906fa85ed46166362"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__SPI.html#gaae4dc76ae4e9d14906fa85ed46166362">sol_spi_mode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPI Transfer Modes. </p>
<p>It may enable and disable clock polarity (cpol) and clock phase (cpha) to define a clock format to be used by the SPI bus.</p>
<p>Depending on CPOL parameter, SPI clock may be inverted or non-inverted.</p>
<p>CPHA parameter is used to shift the sampling phase. If CPHA=0 the data are sampled on the leading (first) clock edge.</p>
<p>If CPHA=1 the data are sampled on the trailing (second) clock edge, regardless of whether that clock edge is rising or falling. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362aed31f6c5aa29f6939643a84d146c1bb5"></a>SOL_SPI_MODE_0&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362a2b842a38daf8b2275fdd7b7c4d31a95b"></a>SOL_SPI_MODE_1&#160;</td><td class="fielddoc">
<p>CPOL = 0 and CPHA = 0 </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362adb708746734272271a3467790e35f883"></a>SOL_SPI_MODE_2&#160;</td><td class="fielddoc">
<p>CPOL = 0 and CPHA = 1 </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ggaae4dc76ae4e9d14906fa85ed46166362a4445edd049cb415353fa6f9afeb792b0"></a>SOL_SPI_MODE_3&#160;</td><td class="fielddoc">
<p>CPOL = 1 and CPHA = 0 CPOL = 1 and CPHA = 1 </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga909f9825eb18e480bb5c05ceff4ee458"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sol_spi_close </td>
          <td>(</td>
          <td class="paramtype">struct sol_spi *&#160;</td>
          <td class="paramname"><em>spi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close an SPI bus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>The SPI bus handle </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1ae35b4b1edd15bc0156543afa31cff8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sol_spi* sol_spi_open </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>bus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structsol__spi__config.html">sol_spi_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open an SPI bus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bus</td><td>The SPI bus number to open </td></tr>
    <tr><td class="paramname">config</td><td>The SPI bus configuration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new SPI bus handle</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For now it only supports one user of the bus at time, 2 or mode devices with different chip select on the same bus will cause concurrency errors. </dd></dl>

</div>
</div>
<a class="anchor" id="gaab25170293f64d99e713c28cd0078e50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sol_spi_transfer </td>
          <td>(</td>
          <td class="paramtype">struct sol_spi *&#160;</td>
          <td class="paramname"><em>spi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *cb_data, struct sol_spi *spi, const uint8_t *tx, uint8_t *rx, ssize_t status)&#160;</td>
          <td class="paramname"><em>transfer_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cb_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a SPI asynchronous transfer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>The SPI bus handle </td></tr>
    <tr><td class="paramname">tx</td><td>The output buffer </td></tr>
    <tr><td class="paramname">rx</td><td>The input buffer </td></tr>
    <tr><td class="paramname">count</td><td>number of bytes to be transfer </td></tr>
    <tr><td class="paramname">transfer_cb</td><td>callback to be called when transmission finish, in case of success the status parameters on callback should be the same value as count, otherwise a error happen. </td></tr>
    <tr><td class="paramname">cb_data</td><td>user data, first parameter of transfer_cb </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if transfer was started.</dd></dl>
<p>As SPI works in full-duplex, data are going in and out at same time, so both buffers must have the count size. Caller should guarantee that both buffers will not be freed until callback is called. Also there is no transfer queue, calling this function when there is transfer happening would return false. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
